import py_midicsv as pm

notes = [[72.448166, 50.27798, 4.305828], [52.95837, 59.565845, 4.3259354], [46.933136, 72.9592, 4.3311424], [61.006737, 54.934776, 4.578083], [60.77861, 59.723156, 4.931431], [63.47565, 61.599792, 5.2947235], [55.19062, 61.91058, 5.714699], [52.65183, 61.378063, 5.9247894], [73.04585, 55.636585, 5.828499], [44.088512, 53.878956, 6.5625916], [44.86314, 62.0931, 6.534897], [59.47903, 50.846134, 6.5747223], [54.41146, 67.25241, 6.996025], [53.284767, 63.192146, 7.334656], [51.908443, 55.811966, 7.49247], [58.18697, 63.006786, 7.446636], [67.080505, 67.44367, 7.191456], [55.7902, 62.11416, 7.454384], [50.53862, 52.922596, 7.3031845], [60.82845, 56.59583, 6.738739], [54.472824, 69.67024, 6.516918], [56.146763, 59.41373, 6.187317], [62.684647, 57.472195, 6.0124054], [57.45377, 62.399437, 6.108513], [62.84825, 61.08933, 6.2078476], [55.84164, 68.325134, 6.2826805], [60.536053, 53.718624, 6.3320045], [63.783943, 60.90175, 6.338791], [60.35947, 56.158848, 6.379463], [52.276142, 56.181347, 6.202286], [61.311733, 65.14624, 6.134903], [52.403366, 57.33102, 6.06736], [47.90626, 63.360466, 6.0683784], [64.88841, 68.99238, 6.4488144], [56.48006, 65.11752, 6.8799477], [63.074696, 58.661167, 6.9403496], [60.796223, 58.28017, 6.5992126], [57.009155, 61.785805, 6.4217033], [57.5744, 57.709213, 6.3159256], [59.075066, 59.87098, 6.2822456], [52.834454, 66.59434, 6.357502], [54.11595, 64.58452, 6.14423], [64.80699, 57.741337, 5.84317], [64.12667, 54.046085, 5.509197], [67.40048, 69.45257, 5.659172], [56.66495, 68.220474, 5.5049515], [64.089294, 57.1027, 5.4681015], [59.826645, 63.70658, 5.590439], [56.60534, 57.93323, 5.333336], [56.465103, 57.888405, 5.237068], [55.106586, 67.33921, 5.372383], [59.27805, 62.51286, 5.250847], [55.517635, 56.690964, 4.8354034], [61.83156, 64.34235, 5.235672], [61.442722, 67.2462, 5.624817], [46.58021, 50.700783, 5.1904335], [63.02244, 61.949707, 5.506439], [60.28433, 61.662907, 5.323551], [54.176273, 53.411865, 4.6487274], [59.362244, 67.90528, 5.1086655], [68.98755, 62.880123, 5.1069717], [55.467464, 60.482265, 5.0869904], [52.68995, 57.323833, 5.101433], [58.166817, 58.48931, 5.266159], [58.312878, 61.608994, 5.1141815], [65.32789, 66.33551, 4.9960785], [57.61814, 66.59241, 4.7012787], [60.843098, 67.8834, 4.95512], [65.0988, 56.66764, 4.858074], [57.92988, 57.324795, 4.8329773], [61.914494, 65.692245, 5.0808334], [61.336864, 63.83631, 4.94355], [59.47769, 63.355476, 4.8992043], [54.09692, 61.167675, 4.603409], [57.6713, 64.80476, 4.9304123], [59.442364, 58.924736, 4.7264442], [61.85708, 65.281525, 4.5265045], [62.157944, 65.09921, 4.40934], [60.36835, 63.37689, 4.438614], [55.700066, 57.895283, 4.2185097], [56.869274, 65.88905, 4.4900665], [57.763653, 59.41571, 4.249878], [58.625244, 64.04907, 4.636711], [59.58419, 62.21584, 4.758259], [63.280323, 58.683643, 4.750305], [60.95225, 65.57347, 4.965214], [58.872276, 65.849556, 4.8334923], [57.892445, 57.183586, 4.170456], [57.937283, 59.467907, 4.0621834], [49.39768, 60.265022, 3.7567863], [61.9758, 65.18946, 4.29665], [62.79642, 62.935352, 4.480156], [53.16543, 60.3907, 4.382057], [62.79888, 65.581314, 4.75613], [66.933495, 62.324066, 4.802479], [53.543266, 57.42888, 4.4361305], [62.308846, 63.7577, 4.7593346], [64.2245, 67.037674, 4.820217], [57.16992, 55.643486, 4.0863533], [62.327545, 61.93008, 4.3164253], [57.199734, 63.184353, 4.1473503], [64.606094, 60.557693, 4.309662], [57.085087, 58.642273, 4.1957245], [55.817047, 64.81523, 4.240528], [58.424778, 63.279682, 4.205658], [58.722862, 60.70563, 4.154331], [58.514626, 62.986176, 4.1947517], [61.401672, 61.71459, 4.1696205], [59.925316, 62.744568, 4.241192], [56.69592, 61.208565, 4.0080757], [56.48759, 62.65718, 4.000408], [58.405483, 62.949223, 4.0019646], [60.423054, 61.3213, 4.0949936], [62.319305, 65.60319, 4.293045], [61.427433, 63.70301, 4.3209343], [54.912277, 57.73844, 4.105385], [61.9174, 62.207714, 4.373966], [63.281216, 65.644135, 4.626377], [60.596867, 65.09714, 4.712002], [63.42026, 60.09311, 4.753029], [62.19968, 64.3419, 4.7533607], [59.631557, 67.10616, 4.7803917], [54.9963, 55.129692, 4.1759834], [60.612534, 60.635788, 4.4159775], [62.04832, 68.54732, 4.6001015], [60.04629, 61.749687, 4.323784], [56.56382, 57.48333, 4.1274605], [61.651623, 67.18014, 4.47353], [60.2677, 61.39784, 4.0635223], [58.9892, 63.461803, 4.122963], [56.900837, 62.7655, 4.034992], [61.551727, 65.770935, 4.1112328], [54.739174, 57.99908, 3.856945], [64.597336, 66.645355, 4.343136], [57.07204, 63.452454, 4.1436768], [56.80805, 61.69313, 4.077759], [58.706474, 58.835907, 3.8801422], [64.751335, 65.37238, 4.0508194], [57.35645, 62.639465, 3.6188507], [61.96345, 63.742985, 3.7999878], [62.942642, 66.593124, 4.0491943], [60.36374, 58.380833, 3.8165245], [62.654045, 64.010956, 4.09338], [59.184414, 60.929604, 3.7950783], [58.55539, 64.53555, 3.808651], [55.32874, 57.75007, 3.5182228], [58.38676, 61.40831, 3.4903564], [61.445297, 65.14593, 3.539898], [61.110466, 63.71243, 3.5492477], [63.9047, 62.123577, 3.7194672], [61.908955, 62.421043, 3.844448], [63.46987, 63.26216, 3.9984856], [62.545887, 65.1201, 4.1967773], [60.376545, 62.09547, 4.207329], [63.6072, 60.075806, 4.3224106], [60.01229, 57.137787, 4.119381], [58.259983, 61.596565, 4.0154686], [57.394283, 61.913784, 3.957058], [60.36762, 62.767834, 4.1079254], [59.253777, 58.831787, 3.996128], [62.658474, 66.152725, 4.2366714], [61.616512, 66.07378, 4.2250214], [59.78254, 62.469486, 4.184372], [65.448364, 66.439224, 4.442734], [60.77274, 62.952393, 4.2037125], [57.734917, 63.89273, 4.1521683], [61.845955, 64.530655, 4.272766], [55.07792, 59.464657, 4.0015182], [65.77989, 66.45616, 4.626869], [61.04266, 58.647446, 4.2416496], [57.272266, 60.49402, 4.1058884], [60.453186, 67.24102, 4.359329], [62.056183, 62.176426, 4.0580406], [63.73337, 64.82764, 4.174553], [56.655933, 58.338936, 3.7336235], [63.414654, 66.19649, 4.336258], [59.198742, 62.15966, 4.208519], [57.18623, 62.83414, 4.287998], [64.191284, 64.94246, 4.4530907], [64.85104, 62.700394, 4.3778343], [58.999695, 62.197517, 4.341717], [57.74857, 61.39032, 4.376232], [60.117268, 62.08761, 4.473736], [60.823185, 61.54835, 4.468277], [59.919044, 61.354397, 4.256504], [62.88819, 66.49028, 4.3970146], [63.591557, 68.50311, 4.5842857], [60.15343, 62.320644, 4.2622604], [60.469208, 63.00332, 4.2647896], [58.998688, 64.0296, 4.2192993], [60.188965, 61.223213, 4.1314774], [61.945072, 62.827732, 4.2881927], [59.679268, 62.506393, 4.054081], [61.461514, 62.154305, 4.0291443], [62.580116, 61.698383, 3.871708], [60.050182, 63.11817, 3.666996], [59.314075, 65.43643, 3.7089958], [57.067234, 60.675476, 3.490631], [56.688103, 59.582394, 3.4876213], [61.592365, 67.39038, 3.7484207], [59.21219, 61.64432, 3.4974174], [57.6476, 62.942585, 3.5817375], [60.686783, 63.658676, 3.729309], [62.61841, 63.056442, 3.7233925], [59.43537, 63.322666, 3.6386375], [61.884968, 65.60097, 3.8462448], [58.471584, 58.667667, 3.4789581], [61.029396, 65.71283, 3.702301], [62.36579, 65.058655, 3.7750168], [60.18924, 64.52139, 3.882866], [57.478455, 60.414024, 3.51931], [62.433186, 65.66461, 3.5358353], [54.960537, 58.317844, 3.1244545], [65.01056, 68.12099, 3.7356033], [61.89591, 63.80269, 3.651661], [56.212784, 57.220036, 3.3139572], [65.09269, 68.35174, 4.1808014], [60.30581, 62.74403, 3.95549], [59.216114, 63.072292, 4.0329895], [62.051193, 65.81037, 4.2657967], [58.623882, 59.937458, 3.7877884], [62.58394, 61.310795, 3.9041977], [60.70245, 64.16022, 3.9189835], [57.60537, 60.18679, 3.6592255], [60.913845, 61.219116, 3.7480545], [58.033607, 62.743, 3.7946205], [57.569927, 61.47084, 3.7395744], [57.85714, 61.177277, 3.622776], [64.90748, 68.02089, 4.1864777], [61.581573, 62.896168, 4.068203], [56.05838, 57.440174, 3.8202324], [58.75661, 61.485317, 3.8416786], [60.02164, 62.260483, 3.9074707], [60.01029, 66.2246, 3.9124947], [64.201385, 67.5394, 3.9917107], [58.608078, 59.76004, 3.5984573], [56.757133, 58.056175, 3.3722305], [63.179317, 63.886333, 3.7382011], [59.26537, 62.036385, 3.582367], [56.60201, 62.506542, 3.4623184], [62.080593, 66.57273, 3.8550797], [62.7739, 64.318375, 3.8900528], [59.410915, 62.20498, 3.7681046], [62.00735, 64.60407, 3.9940224], [57.326317, 60.87045, 3.5997047], [59.363686, 62.980007, 3.8244781], [59.765705, 64.37329, 3.9864464], [63.738018, 66.66908, 4.3430786], [59.87606, 60.756226, 4.069622], [65.26593, 67.0576, 4.3007584], [59.960003, 64.917786, 4.050522], [58.899696, 62.999084, 3.986206], [60.05357, 62.21957, 4.0454407], [61.812984, 67.231674, 4.2567787], [59.21679, 61.878983, 3.9599533], [63.89755, 67.95751, 4.348034], [63.53453, 63.783485, 4.226738], [61.27661, 64.139755, 4.2289352], [58.349133, 63.930485, 4.181122], [62.296085, 63.8584, 4.527008], [59.359028, 63.175964, 4.222618], [57.837547, 60.197147, 3.9729195], [60.897114, 65.18868, 3.831585], [57.55536, 61.33636, 3.444683], [60.042286, 59.884323, 3.5666199], [59.468388, 60.30432, 3.520214], [60.689404, 66.38889, 3.8173027], [55.257626, 57.904083, 3.5710258], [63.55735, 66.100876, 4.209652], [59.76011, 61.286682, 3.807312], [60.013653, 61.889866, 3.750492], [57.544807, 58.302498, 3.4801826], [62.614826, 64.70834, 4.0875435], [59.175648, 62.277306, 4.0913887], [61.92017, 64.52147, 4.12088], [60.2639, 60.67424, 3.8513145], [58.05526, 59.617996, 3.4037132], [60.011993, 62.430508, 3.4217834], [59.670113, 64.2068, 3.4843597], [59.283314, 61.599415, 3.3705254], [59.03721, 62.61375, 3.4341774], [61.048325, 64.58448, 3.5048904], [57.179478, 58.46546, 3.380413], [62.42871, 64.76886, 3.825943], [61.234222, 64.70514, 3.9618645], [59.073086, 61.94815, 3.9435997], [54.92696, 56.779873, 3.6469917], [58.73902, 64.34729, 4.0267982], [61.315063, 66.039, 4.0910683], [59.718773, 61.486885, 3.908043], [61.56094, 63.112164, 4.0714645], [57.515133, 60.861786, 3.952755], [61.282665, 66.0954, 4.3920135], [62.871723, 64.4564, 4.4360275], [57.28134, 59.0193, 3.9212494], [63.498608, 65.00488, 3.998886], [58.286053, 61.227596, 3.4406204], [59.707924, 64.51497, 3.3998451], [63.936344, 67.85071, 3.6981468], [58.812996, 58.376724, 3.2700577], [61.20568, 64.2477, 3.5719872], [62.47824, 66.27234, 3.8304062], [59.13224, 59.644157, 3.6291504], [62.320908, 63.482872, 4.088608], [61.9369, 67.04272, 4.3225594], [58.023045, 61.15695, 3.7615013]]
print(len(notes))
def data_form(text):
    temp = ['0, 0, Header, 1, 3, 256\n', '1, 0, Start_track\n',  '1, 0, Title_t, "Computer Masterpiece"\n', '1, 0, Text_t, "Mr. Computer and Mason Choi"\n', '1, 0, Time_signature, 4, 4, 24, 8', '1, 0, Tempo, 1000000', '1, 0, End_track\n', '2, 0, Start_track\n', '2, 0, Title_t, "Piano"\n', '2, 0, Program_c, 0, 0\n', '2, 0, Control_c, 0, 7, 85\n', '2, 0, Control_c, 0, 10, 76\n']
    # increase tempo value for slower song
    time = 64
    time_shift = 0

    for i in range(len(text) - 1):
        if i == 0:
            temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i][1]))) # Why text[i + 1] not just text[i]????
            time += int(text[i][0])

        elif time_shift != 0:
            time_shift -= 1

        elif (len(text) - 4) > i > 0:
            if 57 < text[i][1] < 66:
                temp.append('2, %d, Note_off_c, 1, %d, 0\n' % (time, int(text[i][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i][1])))
                time += int(text[i][0])
                time_shift = 1
            elif 57 < text[i + 1][1] < 66:
                temp.append('2, %d, Note_off_c, 1, %d, 0\n' % (time, int(text[i][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i + 1][1])))
                time += int(text[i][0])
                time_shift = 2
            elif 57 < text[i + 2][1] < 66:
                temp.append('2, %d, Note_off_c, 1, %d, 0\n' % (time, int(text[i][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i + 1][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i + 2][1])))
                time += int(text[i][0])
                time_shift = 3
            elif 57 < text[i + 3][1] < 66:
                temp.append('2, %d, Note_off_c, 1, %d, 0\n' % (time, int(text[i][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i + 1][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i + 2][1])))
                temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i + 3][1])))
                time += int(text[i][0])
                time_shift = 4

        else:
            temp.append('2, %d, Note_off_c, 1, %d, 0\n' % (time, int(text[i][1])))
            temp.append('2, %d, Note_on_c, 1, %d, 20\n' % (time, int(text[i][1])))
            time += int(text[i][0])
            time_shift = 1

    temp.append('2, %s, End_track\n' % (str(time)))
    temp.append('0, 0, End_of_file')

    return temp


midi_data = data_form(notes)
print(midi_data)
midi_object = pm.csv_to_midi(midi_data)

file_name = '123'
file_name += '.mid'
with open(file_name, "wb") as output_file:
    midi_writer = pm.FileWriter(output_file)
    midi_writer.write(midi_object)

print('Done')
